
## Results {-}

```{r}
read_chunk("src/results.R")
```

```{r rna-seq-dynamics}

```


### HT-sequencing expression data in GEO database {-}

NCBI GEO database shows fast-growing number of high-throughput sequencing data set submissions.
Majority (`r ppub`) of data sets are linked to their respective primary publication (Fig. \@ref(fig:queryfig)`r ref_labels("A", panel_label_case)`).
As can be expected, the gap between published GEO series and published articles is bigger for more recent submissions.
The final results and conclusions in these present or future publications are based on these data sets.
According to NCBI GEO high-throughput sequencing data submission guidelines (https://www.ncbi.nlm.nih.gov/geo/info/seq.html), data sets are required to contain, in addition to metadata and raw data, also final processed data on which published results are directly based.
Final processed data is submitted to GEO as supplementary files.
Minimally these processed files should contain raw or normalized sequence read counts, or peak files of ChIP-Seq data.   
We queried NCBI GEO database for human or mouse expression profiling data sets using high-throughput sequencing.
To focus on biomedical science we narrowed down our query to human and mouse.
We found that, approximately `r perc_mmhs` of GEO data sets contain data from mouse or human origin (Fig. \@ref(fig:queryfig)`r ref_labels("A", panel_label_case)`, right facet).
```{r missingsuppfiles}

```
For human and mouse subset, we were able to identify supplementary files for `r perc_wsuppfile` of GEO series.
Whereas data sets that lack supplemental files show similar publication rate as data sets formally fulfilling submission requirements (Fig. \@ref(fig:queryfig)`r ref_labels("B", panel_label_case)`).

(ref:queryfig) __Datasets submitted to NCBI GEO database featuring expression profiling by high-throughput sequencing__. `r ref_labels("A", panel_label_case)`, GEO series submission dynamics and associated publications of HT-seq data. Left facet, all submissions, N = `r nrow(ds_all)`. Right facet, submissions of human or mouse data sets, N = `r nrow(ds)`. `r ref_labels("B", panel_label_case)`, human or mouse GEO series lacking available supplementary files.

```{r queryfig, fig.cap="(ref:queryfig)"}

```

### Compliance with GEO database submission requirements and data usability for reanalysis {-}

Supplemental HT-seq files uplodaded to NCBI GEO contain most commonly raw sequence data files with 'raw.tar' file extension and associated automatically generated 'filelist.txt' file (Fig. \@ref(fig:commonfilenames)).

(ref:commonfilenames) __Common stubs of SuppFileNames from HT-seq datasets submitted to NCBI GEO database__. Stubs were obtained by removing GEO id string from lowercase converted SuppFileName. RAW.tar and its related filelist.txt file are automatically generated by GEO when compulsory raw sequence data is submitted as a supplemetary file.

```{r commonfilenames, fig.cap="(ref:commonfilenames)"}

```

Raw data is required part of GEO submission, when raw data is provided as supplemental raw.tar file, GEO submits raw data to SRA on behalf of user, this happens in `r supp_raw_perc` of submissions.
Other common files contain annotations 'readme.txt' and processed data: commonly sequence read counts, differential expression results or ChIP-Seq peak counts. 
Reproducibility of ChIP-Seq results is poor and highly dependent on the software tools that were used [@pmid26764273].
Normalised sequence read counts are used for plotting and visual evaluation of the analysis results, but cannot be used to reproduce differential expression analysis. 
However, top tables of differentially expressed genes/features with complete set of raw P values allow direct evaluation of the data and analysis quality underlying tested hypothesis.  

```{r filesofinterest}

```

To start looking for toptables, we first excluded binary, annotation, raw data, graphics, and other non tabular files from the dataset. 
This filter reduced the number of GEO series by `r suppf_oi_perc`.
