
## Materials and methods {-}

```{r}
knitr::read_chunk("R/A01_GEO_query.R")
knitr::read_chunk("R/results_suppfiles.R")
```

```{r query-string}

```


```{r out-strings}

```

```{r}
out_string2 <- str_replace(out_string2, "(\\$)", "\\1")
```


### Data query and import {-}
Data was queried from NCBI GEO database by using eSearch E-Util with search string `r paste0('"_', query,'_"')` using GET function from httr R package [@R-httr].
GEO UIDs were extracted from query results with xml2 package `r myversion("xml2")` [@R-xml2].
UIDs were used to retrieve GEO document summaries using eSummary E-Util.
Metadata was extracted from document summaries using xmlSApply function from XML package `r myversion("XML")` [@R-XML] and FTPLinks were used to identify supplemental files.
We excluded from downloading supplemental files which contained pattern: `r paste(paste0("'", out_string1[1:4],"' ", collapse = ","), "in the file name and we also excluded files with following pattern ", 
paste0("'", c(out_string1[-c(1:4)], out_string2),"' ", collapse = ","))` in the file extension.
Flat tables were imported into R using fread command from package data.table `r myversion("data.table")` [@R-data.table].
MS Excel xls(x) files were imported using read_excel command from package readxl `r myversion("readxl")` [@R-readxl].
Compressed xls(x) files were uncompressed before import using gzip.
HT-seq experiment metadata was extracted from series matrix files. 
Series matrix files were downloaded using GEOquery package `r myversion("GEOquery")` [@R-GEOquery].

### Code availability {-}
Source code is available in github repo `org/reponame`.

