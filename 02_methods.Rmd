
## Materials and methods {-}

```{r}
read_chunk("src/A01_GEO_query.R")
read_chunk("src/results.R")
```

```{r query-string}

```

```{r out_strings}
# also suppfiles_of_interest is generated
```

### Data query and import {-}
Data was queried from NCBI GEO database by using eSearch E-Util with search string `r paste0('"_', query,'_"')` using GET function from httr R package [@Wickham2016httr].
GEO UIDs were extracted from query results with xml2 package `r myversion("xml2")` [@Wickham2017xml2].
UIDs were used to retrieve GEO document summaries using eSummary E-Util.
Metadata was extracted from document summaries using xmlSApply function from XML package `r myversion("XML")` [@Lang2017XML] and FTPLinks were used to identify supplemental files.
We excluded from downloading supplemental files which contained pattern: `r paste(paste0("'", out_string1[1:4],"' ", collapse = ","), "in the file name and we also excluded files with following pattern ", 
paste0("'", c(out_string1[-c(1:4)], out_string2),"' ", collapse = ","))` in the file extension.
Flat tables were imported into R using fread command from package data.table `r myversion("data.table")` [@Dowle2016].
MS Excel xls(x) files were imported using read_excel command from package readxl `r myversion("readxl")` [@Wickham2016].
Compressed xls(x) files were uncompressed before import using gzip.
HT-seq experiment metadata was extracted from series matrix files. 
Series matrix files were downloaded using GEOquery package `r myversion("GEOquery")` [@Davis2007].

### Code availability {-}
Source code is available in github repo `org/reponame`.

